# bve-random-map

[![クリエイティブ・コモンズ・ライセンス](https://i.creativecommons.org/l/by/4.0/80x15.png)](http://creativecommons.org/licenses/by/4.0/)

これは遊ぶたびに線形や景色が変化することを特徴とする、[Bve trainsim](http://bvets.net/) 5 用のシナリオデータです。(が、現在は線形がある程度変化するだけで、風景に関してはまだまだです)

## ダウンロード

[リリースページ](https://github.com/magicant/bve-random-map/releases)からアルファ版シナリオデータをダウンロードできます。

## 必要なもの

このシナリオデータでは以下のデータを参照しています。これらもダウンロードして同じ Scenarios フォルダーに入れてから起動してください。

* [Nagoya_Common 共通ストラクチャパック](https://kumoha12.web.fc2.com/Common.html)
* [GeneralAtsPlugin](https://github.com/uifnm/GeneralAtsPlugin) (※ GeneralAtsPlugin だけダウンロードするよりも [JR 線車両パック](https://github.com/mikangogo/JRTrainPack)ごとダウンロードする方が簡単です)

大概の Windows パソコンには Visual C++ 再頒布可能パッケージがインストールされていると思いますが、もしインストールされていない場合は[マイクロソフトのサイト](https://support.microsoft.com/ja-jp/help/2977003/the-latest-supported-visual-c-downloads)から vc_redist.x86.exe をダウンロードしてインストールしてください。これがインストールされていないと、同梱のサンプル車両のプラグインが動作しません。

## 遊び方

保安装置プラグインの種類によって以下の 3 種類のシナリオファイルがあります。

* ATS-P (snp.dll)
* ATS-P (swp2.dll)
* CS-ATC (メトロ総合プラグイン)

同梱のサンプル車両以外の車両でも保安装置プラグインが対応していれば基本的に運転できると思いますが、その場合のトラブル・不具合等は自己責任でお願いします。

以下の説明では BVE のデフォルトのキー割り当てを前提としているので、自分でキー割り当てを変更している人は適宜読み替えてください。また、説明にある数字のキーは全てテンキーでない方のキーです。

### snp.dll 版

シナリオを開くと「キンコンキンコン」とチャイムが鳴るので `Insert` キーを押して止めます。その後は、ドアが閉まったら普通に発車してください。

制限速度を大きく超えたり赤信号を無視しようとしたりすると ATS-P が強制的にブレーキをかける場合があります。強制的に非常ブレーキがかかった場合はブレーキハンドルを「EB」(非常ブレーキ) に動かしてから `Home` キーを押すと解除できます。

`4` のキーを押すと ATS-S モードに切り替わりますが、このシナリオでは使用しません。`5` のキーで ATS-P モードに戻してください。

### swp2.dll 版

このシナリオでは特殊な操作は不要です。ドアが閉まったあと車掌が合図のブザーを鳴らしたら発車してください。

制限速度を大きく超えたり赤信号を無視しようとしたりすると ATS-P が強制的にブレーキをかける場合があります。強制的に非常ブレーキがかかった場合はブレーキハンドルを「EB」(非常ブレーキ) に動かしてから `Home` キーを押すと解除できます。

`3` や `4` のキーを押すと入換モードや ATS-S モードに切り替わりますが、このシナリオでは使用しません。`5` のキーで ATS-P モードに戻してください。

### CS-ATC 版

メトロ総合プラグインの扱いに慣れている人にとっては、「マスコンキーを地下鉄にセットしてください」とだけ説明すれば十分かと思います。
以下、慣れていない人向けに説明します。

1. シナリオを開いたら、レバーサーが「N」(中立)、ブレーキハンドルが「EB」(非常ブレーキ) になっていることを確認してください。
2. そのまま `8` のキーを 1 回押して、マスコンキーを地下鉄にセットします。(速度計の右下の鍵マークのところが「Metro」になれば OK)
   * 押し過ぎてマスコンキーが JR にセットされてしまったときは `7` のキーを押して戻した後、やり直してください。
3. この後は普通にレバーサーを「F」(前進)、ブレーキハンドルを常用に切り替えてください。
   * ブレーキを非常から常用に切り替えたときに数秒間ベルが鳴りますが、正常です。
4. ドアが閉まった後、車掌が合図のブザーを鳴らしたら発車してください。

運転中は、速度計に黄色い三角で制限速度が表示されます。この速度を超えると自動的にブレーキがかかります。

一部の駅では ORP が動作することがあります。この時は速度計の左下に「P」マークが点灯し、段々と制限速度が下がってくるので、制限速度を超えないように注意深く運転してください。もし制限速度を超えてしまうと非常ブレーキがかかります。その場合はブレーキハンドルを一旦「EB」(非常ブレーキ) に動かしてからブレーキを緩めると再発進できます。

### EB 装置

同梱のサンプル車両には EB 装置が搭載されており、シナリオの種類に関係なく動作します。

走行中に 1 分間ずっとハンドルを動かさないでいると「EB」ランプが点灯しブザーが鳴ります。この場合は 5 秒以内にハンドルを動かすか `Delete` キーを押すと元に戻ります。5 秒以内にこれをしないと強制的に非常ブレーキがかかります。もし非常ブレーキがかかった場合はブレーキハンドルを一旦「EB」(非常ブレーキ) に動かしてからブレーキを緩めると再発進できます。

### TASC/ATO

同梱のサンプル車両は [bve-autopilot](https://github.com/magicant/bve-autopilot) プラグインを搭載しているので TASC と ATO が使用できます。

シナリオを開いた直後は TASC と ATO はオフになっています。オンにするには、レバーサーが「N」(中立) かつブレーキハンドルが「EB」(非常ブレーキ) になっている状態で `0` のキーを押してください。押すたびに「両方オフ」→「TASC のみオン」→「両方オン」の順で切り替わります。

TASC がオンになっている場合、停車駅が近付くと自動的にブレーキがかかり所定位置に停車します。

TASC のみオンの場合、停車駅に到着したら手動でブレーキをかけてください。ドアが閉まると TASC の自動ブレーキは解除されます。

ATO をオンにした場合は、以下をすべて満たした状態で `0` のキーを押すと ATO が列車を発進させ、あとは ATO が自動で運転します。

* ドアが閉まっている
* レバーサーが「F」(前進)
* ブレーキハンドルが「N」(中立)

同梱のサンプル車両では ATO 運転中でも EB 装置が動作するのでご注意ください。(ブザーが鳴ったら `Delete` キー)

## 不具合

このシナリオではマップファイル内で数式や乱数を駆使して毎回異なる路線を生成しています。そのためいろいろなところで細かい不具合が生ずる可能性があります。また、路線を機械的に生成するという仕組み上、不具合があると分かっていても必ずしも直せないことをご了承ください。現在把握している主な不具合は以下のとおりです。

* CS-ATC 版で、制限速度区間を抜け切る前に信号の速度が上がってしまうことがある。
* ATS-P 版で、 減速を TASC/ATO だけに任せていると ATS-P の照査に引っ掛かることがある。

## ライセンス (利用条件)

このシナリオデータは [magicant](https://github.com/magicant) が作成しました。

このレポジトリーに含まれるファイルは[クリエイティブ・コモンズ 表示 4.0 国際 ライセンス](https://creativecommons.org/licenses/by/4.0/)の元で自由に使用できます。ただし、以下のファイルを除きます。

 - bve-autopilot.dll プラグイン
   - このファイルのライセンスは [LGPL 2.1](https://www.gnu.org/licenses/old-licenses/lgpl-2.1.html) です。
 - DetailManager.dll プラグイン
   - このファイルは Rock_On さんが公開されたソースコードを magicant がコンパイルしたもので、著作権フリーです。

## 謝辞

このシナリオデータは他の多くの方の功績の上に成り立っています。まことに有難うございます。

 - mackoy さんは [Bve trainsim](http://bvets.net/) を開発なさいました。
 - Rock_On さんは [DetailManager プラグイン](https://bitbucket.org/mikangogo/detailmanager)を開発なさいました。
 - Rock_On さんと Unicorn さんは [GeneralAtsPlugin](https://github.com/uifnm/GeneralAtsPlugin) を開発なさいました。
 - 樽ﾓﾄさんは [Nagoya_Common 共通ストラクチャパック](https://kumoha12.web.fc2.com/Common.html)を制作なさいました。

## 質問・問い合わせ

- [ツイッター](https://twitter.com/tnacigam)で
- [メール](mailto:magicant@wonderwand.net)で
- [Issues](https://github.com/magicant/bve-random-map/issues/new) で
